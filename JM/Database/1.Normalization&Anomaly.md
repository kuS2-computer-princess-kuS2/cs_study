# 정규화란?

---

- 이상 현상을 제거하기 위해 데이터베이스를 올바르게 **설계**해나가는 과정 또는 릴레이션을 **분해**하는 과정
- 하나의 테이블을 여러개의 테이블로 분해해 중복성, 종속성을 줄이는 기법

## 장점

- 중복 제거
- Null 값 최소화
- 데이터 구조 안정성 최대화

## 과정 : 제 X 정규형 (XNF)

: 논리적 데이터 모델 구축시 3차 정규형이 기본이고, 정규화 과정이 깊어질 수록 제약 조건이 많아져 설계하기 까다로운 릴레이션이 된다. 

- (X=1) : 릴레이션의 모든 도메인이 원자값이다.
    - 유일한 값, 식별성
- (X=2) : 부분 함수적 종속 제거(모든 속성이 기본키에 완전 함수적 종속)
- (X=3) : 이행적 함수 종속 제거
- 보이스 코드 정규형(X=BC) : 모든 결정자가 후보키
- (X=4) : 다치 종속 제거
- (X=5) : 조인 종속 제거

# 이상 현상

---

이상 현상은 불필요한 데이터 중복으로 인해 릴레이션에 대한 데이터 삽입, 수정, 삭제 연산을 할 때 발생할 수 있는 부작용이다.

## 이상 현상의 종류

- 삽입 이상 : 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야하는 문제
- 갱신 이상 : 중복 튜플 중 일부만 변경해 데이터가 불일치하게 되는 문제
- 삭제 이상 : 튜플을 삭제하면 꼭 필요한 데이터까지 같이 삭제되는 데이터 손실 문제

# 함수 종속성

---

속성들 간의 관련성

X → Y 일 때, 

X가 Y를 함수적으로 결정한다 = Y가 X에 함수적으로 종속되어 있다. 

- X는 결정자, Y는 종속자라고 한다.

릴레이션 내 모든 튜플을 대상으로 하나의 X값에 대한 Y값이 항상 하나인 경우를 의미한다.

- 속성에 들어올 수 있는 값들을 고려해 판단해야한다.
- 기본키와 후보키는 릴레이션의 다른 모든 속성들을 함수적으로 결정한다.

## 완전 함수 종속

속성집합 Y가 속성집합 X 전체에 대해서만 함수적으로 종속된 경우를 말한다. 

- 성적이 속성집합Y이고, {학번, 과목코드}가 속성집합 X
- 성적은 {학번, 과목코드}의 어떤 부분집합에도 함수적으로 종속되어있지않다.
- 학번만으로, 과목코드 만으로 성적을 결정지을 수 없기 때문이다.

## 부분 함수 종속

속성집합Y가 속성집합 X의 전체가 아닌 일부분에도 함수적으로 종속됨을 의미한다.

- 이름이 속성집합 Y이고, {학번, 과목코드}가 속성집합 X
- 이름은 {학번, 과목코드}에 함수적으로 종속되며 X의 일부인 학번에도 함수적으로 종속된다.
- 이름은 학번에의해 결되고 {학번, 과목 코드}에 의해 고유하게 구분될 수 있기 때문이다.

## 이행적 함수 종속

X→Y, Y-Z가 있으면 논리적으로 X → Z가 성립된다. 이를 Z가 X에 이행적으로 함수 종속되었다고한다.

- X를 알면 Y를 알고 그를 통해 Z를 알 수 있는 경우

# 예시

---

## 제 1 정규형

고객 테이블에 이벤트 정보를 같이 저장함

- 이벤트에 참여한 고객만 해당 테이블에 삽입이 가능하다 : `삽입이상`
- 이벤트를 여러번 참여했다면 고객 정보가 중복이 되고, 하나의 고객 정보(ex. 등급)를 수정하면 같은 고객의 다른 정보는 수정이 되지않는 문제가 발생한다 : `갱신이상`
- 이벤트 참여를 취소해 이벤트 정보 삭제 시 고객 정보도 삭제되는 문제가 발생한다 : `삭제이상`

## 제 2 정규형

고객 테이블과 이벤트 테이블로 분해

- 고객 등급에 새로운 등급이 생겨도 브론즈 고객이 있으면 삽입되지 않는다 : `삽입이상`
- 등급이 변경되면 자동으로 할인율도 변경되어야한다 : `갱신이상`
- 고객이 탈퇴하면 특정 등급과 할인율도 같이 삭제된다 → 정보 손실: `삭제이상`
- 이행적 함수 종속 관계
    - 예시
    - 고객 아이디 → 등급
    - 고객 아이디 → 할인율
    - 등급 → 할인율
    - 고객 아이디+이벤트 번호

## 제 3 정규형

고객 테이블에서 등급과 할인율 정보를 분해 

- 이행적 함수 종속 제거
- 이를 통해, 데이터 삽입, 수정, 삭제가 쉬워짐. 하지만 검색이 오래 걸릴 수 있다.

참고

https://zz132456zz.tistory.com/36

https://datamoney.tistory.com/257

https://yaboong.github.io/database/2018/03/09/database-anomaly-and-functional-dependency/

https://dodo000.tistory.com/20
